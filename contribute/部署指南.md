# OpenBook ç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¶æ„

OpenBook æ˜¯ä¸€ä¸ªå®Œæ•´çš„å‰åç«¯åˆ†ç¦»ç³»ç»Ÿï¼š
- **å‰ç«¯**: HTML + CSS + JavaScript (çº¯é™æ€æ–‡ä»¶)
- **åç«¯**: Python FastAPI + SQLAlchemy + SQLite/PostgreSQL
- **è®¤è¯**: JWT Token + OAuth æ¨¡æ‹Ÿ

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### åç«¯ç¯å¢ƒ
- Python 3.8+
- pixi åŒ…ç®¡ç†å™¨ï¼ˆæ¨èï¼‰æˆ– pip

### å‰ç«¯ç¯å¢ƒ
- ç°ä»£æµè§ˆå™¨ï¼ˆChrome, Firefox, Safari, Edgeï¼‰
- æœ¬åœ°HTTPæœåŠ¡å™¨ï¼ˆå¯é€‰ï¼Œç”¨äºå¼€å‘ï¼‰

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ pixiï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd openbook

# 2. å¯åŠ¨åç«¯æœåŠ¡
cd backend
pixi install
pixi run dev

# 3. å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd ..
# ä½¿ç”¨Pythonç®€å•HTTPæœåŠ¡å™¨
python -m http.server 8080

# æˆ–ä½¿ç”¨Node.js http-server
npx http-server -p 8080 -c-1
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨ä¼ ç»Ÿæ–¹å¼

```bash
# 1. åç«¯éƒ¨ç½²
cd backend
pip install -r requirements.txt
python run.py --reload

# 2. å‰ç«¯éƒ¨ç½²
cd ..
python -m http.server 8080
```

## ğŸ”— è®¿é—®åœ°å€

éƒ¨ç½²å®Œæˆåï¼Œå¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰ç«¯ç•Œé¢**: http://localhost:8080
- **åç«¯API**: http://localhost:8000
- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **ReDocæ–‡æ¡£**: http://localhost:8000/redoc

## âš™ï¸ é…ç½®è¯´æ˜

### åç«¯é…ç½®

1. **ç¯å¢ƒå˜é‡é…ç½®**
```bash
cd backend
cp .env.example .env
```

2. **ç¼–è¾‘ .env æ–‡ä»¶**
```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///./openbook.db

# JWTé…ç½®
SECRET_KEY=your-super-secret-key-change-in-production
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# æœåŠ¡å™¨é…ç½®
HOST=0.0.0.0
PORT=8000

# CORSé…ç½®
ALLOWED_ORIGINS=["http://localhost:8080", "http://127.0.0.1:8080"]
```

### å‰ç«¯é…ç½®

å‰ç«¯APIæœåŠ¡åœ°å€åœ¨ `api.js` ä¸­é…ç½®ï¼š
```javascript
// ä¿®æ”¹baseURLä¸ºä½ çš„åç«¯åœ°å€
this.baseURL = 'http://localhost:8000/api';
```

## ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–

ç³»ç»Ÿä¼šåœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨å’Œç¤ºä¾‹æ•°æ®ï¼š

### ç¤ºä¾‹ç”¨æˆ·
- **å¼ ä¸‰**: zhangsan@example.com (standardæƒé™)
- **æå››**: lisi@example.com (premiumæƒé™)  
- **ç®¡ç†å‘˜**: admin@example.com (adminæƒé™)

### ç¤ºä¾‹èµ„æº
- GPU-01: NVIDIA RTX 4090 - æ·±åº¦å­¦ä¹ ä¸“ç”¨
- GPU-02: NVIDIA RTX 4090 - å›¾åƒå¤„ç†ä¸“ç”¨
- GPU-03: NVIDIA RTX 4080 - é€šç”¨è®¡ç®—
- GPU-04: NVIDIA RTX 4080 - é€šç”¨è®¡ç®—

## ğŸ“± ä½¿ç”¨æµç¨‹

### 1. ç”¨æˆ·ç™»å½•
1. è®¿é—®å‰ç«¯åœ°å€
2. è¾“å…¥é‚®ç®±ï¼ˆå»ºè®®ä½¿ç”¨ç¤ºä¾‹é‚®ç®±ï¼‰
3. ç‚¹å‡»"é€šè¿‡ OAuth ç™»å½•"
4. ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºæˆ–ç™»å½•ç”¨æˆ·

### 2. é¢„çº¦ç®¡ç†
1. åœ¨ä¸»é¡µæŸ¥çœ‹ç°æœ‰é¢„çº¦
2. ç‚¹å‡»"å»é¢„çº¦"è¿›å…¥æ—¥å†é¡µé¢
3. æ‹–æ‹½é€‰æ‹©æ—¶é—´æ®µ
4. å¡«å†™ä»»åŠ¡åç§°å¹¶ç¡®è®¤é¢„çº¦

### 3. é¢„çº¦æ“ä½œ
- **æœªå¼€å§‹çš„é¢„çº¦**: å¯ä»¥åˆ é™¤
- **è¿›è¡Œä¸­çš„é¢„çº¦**: å¯ä»¥é‡Šæ”¾å‰©ä½™æ—¶é—´æˆ–å»¶é•¿
- **å·²å®Œæˆçš„é¢„çº¦**: ä»…ä¾›æŸ¥çœ‹

## ğŸ”§ å¼€å‘æ¨¡å¼

### åç«¯å¼€å‘

```bash
cd backend

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
pixi run dev

# è¿è¡Œä»£ç æ£€æŸ¥
pixi run check

# è¿è¡Œæµ‹è¯•
pixi run test

# æ ¼å¼åŒ–ä»£ç 
pixi run format
```

### å‰ç«¯å¼€å‘

å‰ç«¯ä¸ºçº¯é™æ€æ–‡ä»¶ï¼Œä¿®æ”¹ååˆ·æ–°æµè§ˆå™¨å³å¯çœ‹åˆ°æ•ˆæœã€‚

æ¨èä½¿ç”¨æ”¯æŒçƒ­é‡è½½çš„å¼€å‘æœåŠ¡å™¨ï¼š
```bash
# ä½¿ç”¨ live-server
npm install -g live-server
live-server --port=8080

# æˆ–ä½¿ç”¨ Python
python -m http.server 8080
```

## ğŸš€ ç”Ÿäº§éƒ¨ç½²

### 1. åç«¯ç”Ÿäº§éƒ¨ç½²

**ä½¿ç”¨ Docker**
```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY backend/requirements.txt .
RUN pip install -r requirements.txt

COPY backend/ .
EXPOSE 8000

CMD ["python", "run.py"]
```

**ä½¿ç”¨ Systemd**
```ini
[Unit]
Description=OpenBook API Server
After=network.target

[Service]
Type=simple
User=openbook
WorkingDirectory=/opt/openbook/backend
ExecStart=/opt/openbook/venv/bin/python run.py
Restart=always

[Install]
WantedBy=multi-user.target
```

### 2. å‰ç«¯ç”Ÿäº§éƒ¨ç½²

**ä½¿ç”¨ Nginx**
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    root /var/www/openbook;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location /api/ {
        proxy_pass http://localhost:8000/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 3. æ•°æ®åº“é…ç½®

**PostgreSQLï¼ˆæ¨èï¼‰**
```env
DATABASE_URL=postgresql://username:password@localhost/openbook
```

**MySQL**
```env
DATABASE_URL=mysql://username:password@localhost/openbook
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. JWTé…ç½®
```env
# ç”Ÿæˆå®‰å…¨çš„å¯†é’¥
SECRET_KEY=$(openssl rand -hex 32)
```

### 2. CORSé…ç½®
```env
# é™åˆ¶å…è®¸çš„åŸŸå
ALLOWED_ORIGINS=["https://your-domain.com"]
```

### 3. HTTPSé…ç½®
ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®HTTPSï¼š
- ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦
- é…ç½®HTTPé‡å®šå‘åˆ°HTTPS
- è®¾ç½®å®‰å…¨å¤´éƒ¨

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. åº”ç”¨ç›‘æ§
```bash
# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pixi run health

# æŸ¥çœ‹æ—¥å¿—
tail -f openbook.log
```

### 2. æ•°æ®åº“ç›‘æ§
```sql
-- æŸ¥çœ‹é¢„çº¦ç»Ÿè®¡
SELECT status, COUNT(*) FROM bookings GROUP BY status;

-- æŸ¥çœ‹èµ„æºä½¿ç”¨ç‡
SELECT resource_id, COUNT(*) as booking_count 
FROM bookings 
WHERE start_time >= NOW() - INTERVAL '7 days' 
GROUP BY resource_id;
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **CORSé”™è¯¯**
   - æ£€æŸ¥åç«¯CORSé…ç½®
   - ç¡®è®¤å‰ç«¯è¯·æ±‚çš„åŸŸååœ¨å…è®¸åˆ—è¡¨ä¸­

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥æ•°æ®åº“é…ç½®
   - ç¡®è®¤æ•°æ®åº“æœåŠ¡è¿è¡Œæ­£å¸¸

3. **è®¤è¯å¤±è´¥**
   - æ£€æŸ¥JWTå¯†é’¥é…ç½®
   - æ¸…é™¤æµè§ˆå™¨localStorage

4. **APIè¯·æ±‚å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### æ—¥å¿—æŸ¥çœ‹

```bash
# åç«¯æ—¥å¿—
tail -f backend/openbook.log

# ç³»ç»Ÿæ—¥å¿—
journalctl -u openbook-api -f

# Nginxæ—¥å¿—
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. åç«¯ä¼˜åŒ–
- ä½¿ç”¨è¿æ¥æ± 
- æ·»åŠ æ•°æ®åº“ç´¢å¼•
- å®ç°APIç¼“å­˜
- ä½¿ç”¨å¼‚æ­¥å¤„ç†

### 2. å‰ç«¯ä¼˜åŒ–
- å‹ç¼©é™æ€èµ„æº
- ä½¿ç”¨CDN
- å®ç°æ‡’åŠ è½½
- æ·»åŠ ç¼“å­˜ç­–ç•¥

### 3. æ•°æ®åº“ä¼˜åŒ–
- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
- ä¼˜åŒ–æŸ¥è¯¢è¯­å¥
- æ·»åŠ åˆé€‚çš„ç´¢å¼•
- ç›‘æ§æ…¢æŸ¥è¯¢

## ğŸ”„ å¤‡ä»½å’Œæ¢å¤

### æ•°æ®å¤‡ä»½
```bash
# SQLiteå¤‡ä»½
cp backend/openbook.db backup/openbook_$(date +%Y%m%d).db

# PostgreSQLå¤‡ä»½
pg_dump openbook > backup/openbook_$(date +%Y%m%d).sql
```

### æ•°æ®æ¢å¤
```bash
# SQLiteæ¢å¤
cp backup/openbook_20240101.db backend/openbook.db

# PostgreSQLæ¢å¤
psql openbook < backup/openbook_20240101.sql
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ç¯å¢ƒè¦æ±‚æ˜¯å¦æ»¡è¶³
2. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
4. é˜²ç«å¢™å’Œç½‘ç»œè®¾ç½®

æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯·å‚è€ƒï¼š
- åç«¯APIæ–‡æ¡£: http://localhost:8000/docs
- ç³»ç»Ÿä½¿ç”¨è¯´æ˜: ä½¿ç”¨è¯´æ˜.md
- åç«¯å¼€å‘æ–‡æ¡£: backend/README.md
